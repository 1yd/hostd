<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'/>
    <meta http-equiv="X-UA-Compatible" content="chrome=1"/>
    <meta name="description"
          content="Hostd : Tools to custom your domain resolved rules. Used BlackHole as DNS server."/>
    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/bootstrap.css">
    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.png"/>

    <style>
        pre#code {
            background-color: #373737;
            color: #ffffff;
            padding: 0;
        }

        .row-fluid [class*="span"]:nth-child(3n+1) {
            margin-left: 0;
        }
    </style>

    <title>Hostd</title>
</head>

<body>

<!-- HEADER -->
<div id="header_wrap" class="outer">
    <header class="inner">
        <a id="forkme_banner" href="https://github.com/code4craft/hostd">View on GitHub</a>

        <h1 id="project_title">Hostd</h1>

        <h2 id="project_tagline">Tools to custom your domain resolved rules. Used <a
                href="https://github.com/code4craft/blackhole" target="_blank">BlackHole</a> as DNS server.</h2>

        <section id="downloads">
            <a class="zip_download_link" href="https://github.com/code4craft/hostd/zipball/master">Download this project
                as a .zip file</a>
            <a class="tar_download_link" href="https://github.com/code4craft/hostd/tarball/master">Download this project
                as a tar.gz file</a>
        </section>
    </header>
</div>

<!-- MAIN CONTENT -->
<div id="main_content_wrap" class="outer">
    <section id="main_content" class="inner">
        <div class="row-fluid">
            <div class="span12">
                <h2>
                    <a name="hostd" class="anchor" href="#hostd"><span class="octicon octicon-link"></span></a>管理Hostd
                </h2>
            </div>

            <div class="span12">
                <h2>
                    <a class="anchor" href="#hostd"><span class="octicon octicon-link"></span></a>下载</h2>

                <p>使用下面的命令进行自动下载和安装：</p>

                <div class="span12">
        <pre class="span12" id="code">

    curl http://code4craft.github.io/hostd/install.sh | sh
                </pre>
                </div>
                <div class="span12">
                    <h2>
                        <a class="anchor" href="#hostd"><span class="octicon octicon-link"></span></a>管理</h2>

                    <p>首先，你需要修改BlackHole的配置(/usr/local/blackhole/conf/blackhole.conf)，将转发的DNS服务器修改为你的内网DNS服务器。</p>
                </div>
                    <div class="span12">
                <pre class="span12" id="code">

    dns=[你的内网DNS地址]
                </pre>
                    </div>
                <div class="span12">
                    <p>BlackHole支持多个DNS配置，配置靠前的DNS服务器的返回值优先级更高。如果你在内网进行了DNS拦截，请把你的内网DNS服务器配置到第一位。</p>
                       <p> BlackHole本身也具有缓存和自定义域名配置的功能，你也可以直接使用BlackHole作为内网服务器，并将转发的DNS服务器设置为ISP提供的地址，一个更详细的BlackHole配置请看这里<a
                            href="https://github.com/code4craft/blackhole/blob/master/server/README.md" target="_blank">BlackHole配置和使用说明</a>。
                    </p>

                    <p>启动blackhole:</p>
                </div>
                <div class="span12">
                <pre class="span12" id="code">

    sudo /usr/local/blackhole/blackhole.sh start
                </pre>
                </div>
                <div class="span12">

                    <p>Hostd是一个标准的Java Web项目，这里我们使用了一个jetty的轻量级封装(<a href="https://github.com/code4craft/war4e">war4e.jar</a>)作为容器，你也可以使用你常用的容器(例如Tomcat、Jboss)启动它。
                    </p>
                    <p>启动Hostd：</p>
                </div>

                <div class="span12">
                <pre class="span12" id="code">

    sudo java -jar /usr/local/hostd/war4e.jar /usr/local/hostd/hostd-server-0.1.0.war -p 80 &
                </pre>
                </div>
                <div class="span12">


                    <p>
                        Hostd使用sqlite作为存储，所有的数据文件保存在/usr/local/hostd/zonesfile.db里。你也可以配置使用mysql来进行连接：解压hostd-server-0.1.0.war，并修改WEB-INF/classes/spring/applicationContext-myBatis.xml，配置datasource即可。建表语句见
                        <a target="_blank" href="https://github.com/code4craft/hostd/blob/master/server/sqlschema/mysql.sql">这里</a>。</p>
                </div>
            </div>
        </div>

    </section>
</div>

<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
    <footer class="inner">
        <p class="copyright">Hostd maintained by <a href="https://github.com/code4craft">code4craft</a></p>

        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
    </footer>
</div>

<script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-41279861-1");
        pageTracker._trackPageview();
    } catch (err) {
    }
</script>


</body>
</html>
